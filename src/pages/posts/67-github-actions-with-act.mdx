import PostUtil from "../../utils/postUtil"; import PostLayout from "../../components/post/PostLayout";

GitHub ActionsëŠ” GitHubì—ì„œ ì œê³µí•˜ëŠ” CI/CD ì„œë¹„ìŠ¤ì´ë‹¤. GitHub ë ˆí¬ì§€í† ë¦¬ì— ì´ë²¤íŠ¸ê°€ ë°œìƒí•œ ì‹œì ì— ë§ì¶° ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆê³ , ì´ë¥¼ í†µí•´ ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬ ë“±ì„ ìë™í™”í•  ìˆ˜ ìˆë‹¤.

<div style={{display: 'flex', alignItems: "center", gap: '8px'}}>
![Untitled](/image/66/commit-list.png)

![Untitled](/image/66/action-list.png)
</div>

ì›Œí¬í”Œë¡œìš°ê°€ ì˜ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì»¤ë°‹ì„ ìê¾¸ í‘¸ì‹œí•˜ë‹¤ ë³´ë©´, ìœ„ì™€ ê°™ì´ ì»¤ë°‹ ëª©ë¡ì´ ë„ˆë¬´ ì§€ì €ë¶„í•´ì§„ë‹¤. ì´ëŸ´ ë•ŒëŠ” ë¡œì»¬ì—ì„œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•´ë³´ëŠ” ê²ƒì´ ì¢‹ë‹¤.

[act](https://github.com/nektos/act)ë¥¼ ì‚¬ìš©í•˜ë©´ ê¹ƒí—ˆë¸Œ ì•¡ì…˜ ì›Œí¬í”Œë¡œìš°ì˜ ì‘ì—…ì„ ë¡œì»¬ì—ì„œ ì‹¤í–‰ì‹œì¼œ ë³¼ ìˆ˜ ìˆë‹¤. GitHub Actionsë¥¼ í†µí•´ ì‹¤í–‰ë˜ëŠ” ê²ƒê³¼ ê±°ì˜ í¡ì‚¬í•˜ê²Œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— yaml ë¬¸ë²• ì˜¤ë¥˜ ë“± ì›¬ë§Œí•œ ì˜¤ë¥˜ëŠ” ë¯¸ë¦¬ ì¡ì•„ë‚¼ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ GitHub ì•¡ì…˜ê³¼ ì™„ë²½í•˜ê²Œ ë˜‘ê°™ì´ ë™ì‘í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ì¼ë¶€ ì•¡ì…˜ì´ GitHub Actionsì—ì„œëŠ” ë‹¤ë¥´ê²Œ ë™ì‘í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ì£¼ì˜í•´ì•¼ í•œë‹¤.

## actë¡œ job ì‹¤í–‰í•˜ê¸°

actëŠ” ë„ì»¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì—, ë¨¼ì € ë„ì»¤ë¥¼ ì„¤ì¹˜í•´ì•¼ í•œë‹¤. ë„ì»¤ëŠ” [ì—¬ê¸°](https://docs.docker.com/get-docker/)ì—ì„œ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.

act ì„¤ì¹˜ëŠ” [ì—¬ê¸°](https://github.com/nektos/act#installation-through-package-managers)ë¥¼ ì°¸ê³ í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €ì— ë§ì¶° ì„¤ì¹˜í•˜ë©´ ëœë‹¤. GitHub CLI extensionìœ¼ë¡œë„ ì œê³µëœë‹¤!

<br/>

actë¥¼ ì„¤ì¹˜í•œ í›„, ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•˜ê³  ì‹¶ì€ ë ˆí¬ì§€í† ë¦¬ë¡œ ì´ë™í•´ ì•„ë˜ ì»¤ë§¨ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” job ëª©ë¡ì„ ë³´ì—¬ì¤€ë‹¤.

```bash
âœ act -l

Stage  Job ID              Job name            Workflow name           Workflow file           Events
0      make                make                make recent post list   make-post-list.yml      push
0      test_repo_dispatch  test_repo_dispatch  test_repo_dispatch.yml  test_repo_dispatch.yml  repository_dispatch
0      update-cache        update-cache        update-cache.yml        update-cache.yml        push
```

`act -j <job name>` ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•˜ë©´ í•´ë‹¹ jobì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

<details>
    <summary>job ì‹¤í–‰ ì˜ˆì‹œ</summary>

    ì•„ë˜ëŠ” node_modulesë¥¼ ìºì‹±í•˜ëŠ” jobì„ ì‹¤í–‰í•œ ì˜ˆì‹œì´ë‹¤. GitHub Actionsë¥¼ í†µí•´ ì‹¤í–‰í–ˆì„ ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ actions/checkout, actions/cache ë“±ì˜ ì•¡ì…˜ë„ ì‹¤í–‰ ê°€ëŠ¥í•˜ë‹¤.

```bash
âœ act -j update-cache

[update-cache.yml/update-cache] ğŸš€  Start image=catthehacker/ubuntu:act-latest
[update-cache.yml/update-cache]   ğŸ³  docker pull image=catthehacker/ubuntu:act-latest platform= username= forcePull=true
[update-cache.yml/update-cache]   ğŸ³  docker create image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[]
[update-cache.yml/update-cache]   ğŸ³  docker run image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[]
[update-cache.yml/update-cache]   â˜  git clone 'https://github.com/actions/cache' # ref=v3
[update-cache.yml/update-cache]   â˜  git clone 'https://github.com/actions/setup-node' # ref=v3
[update-cache.yml/update-cache] â­ Run Main checkout
[update-cache.yml/update-cache]   ğŸ³  docker cp src=/Users/miridih/project/ooooorobo.github.io/. dst=/Users/miridih/project/ooooorobo.github.io
[update-cache.yml/update-cache]   âœ…  Success - Main checkout
[update-cache.yml/update-cache] â­ Run Main cache
[update-cache.yml/update-cache]   ğŸ³  docker cp src=/Users/miridih/.cache/act/actions-cache@v3/ dst=/var/run/act/actions/actions-cache@v3/
[update-cache.yml/update-cache]   ğŸ³  docker exec cmd=[node /var/run/act/actions/actions-cache@v3/dist/restore/index.js] user= workdir=
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::Resolved Keys:
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::["yarn-9cc36377e528932831996b38128b0fdc6877c9ca79b68cc3d5662350b35f01ca"]
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::Checking zstd --quiet --version
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::1.4.8
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::zstd version: 1.4.8
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::Resource Url: http://192.168.0.5:61533/_apis/artifactcache/cache?keys=yarn-9cc36377e528932831996b38128b0fdc6877c9ca79b68cc3d5662350b35f01ca&version=7fcda33c1e1d849a13bcc06f49b9ab64efc01ca9dabe4d7a8d0d387feef4fc88
[update-cache.yml/update-cache]   âš™  ***
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::Cache Result:
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::{"archiveLocation":"***","cacheKey":"yarn-9cc36377e528932831996b38128b0fdc6877c9ca79b68cc3d5662350b35f01ca","result":"hit"}
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::Archive Path: /tmp/04d57fde-08fb-4a24-b454-0f5810184ed4/cache.tzst
(ìƒëµ)
| Cache Size: ~50 MB (52189089 B)
| [command]/usr/bin/tar -xf /tmp/04d57fde-08fb-4a24-b454-0f5810184ed4/cache.tzst -P -C /Users/miridih/project/ooooorobo.github.io --use-compress-program unzstd
| Cache restored successfully
| Cache restored from key: yarn-9cc36377e528932831996b38128b0fdc6877c9ca79b68cc3d5662350b35f01ca
[update-cache.yml/update-cache]   âœ…  Success - Main cache
[update-cache.yml/update-cache]   âš™  ::set-output:: cache-hit=true
[update-cache.yml/update-cache] â­ Run Post cache
[update-cache.yml/update-cache]   ğŸ³  docker exec cmd=[node /var/run/act/actions/actions-cache@v3/dist/save/index.js] user= workdir=
[update-cache.yml/update-cache]   ğŸ’¬  ::debug::Cache state/key: yarn-9cc36377e528932831996b38128b0fdc6877c9ca79b68cc3d5662350b35f01ca
| Cache hit occurred on the primary key yarn-9cc36377e528932831996b38128b0fdc6877c9ca79b68cc3d5662350b35f01ca, not saving cache.
[update-cache.yml/update-cache]   âœ…  Success - Post cache
[update-cache.yml/update-cache] ğŸ  Job succeeded
```
</details>

### ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì‹œ í•„ìš”í•œ ë°ì´í„° ì „ë‹¬í•˜ê¸°

`repository_dispatch` ì›¹í›…ì„ í†µí•´ ì‹¤í–‰ë˜ëŠ” ì•¡ì…˜ì˜ ê²½ìš°, ì¶”ê°€ë¡œ í•„ìš”í•œ ë°ì´í„°ë¥¼ ë°›ì•„ì™€ì•¼ í•œë‹¤. ì´ëŸ´ ê²½ìš° `â€”-event_path` ì˜µì…˜ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤.

ë¨¼ì €, ë°ì´í„°ë¥¼ ë‹´ëŠ” json íŒŒì¼ì„ ì‘ì„±í•œë‹¤.<br/>
ì´ json íŒŒì¼ì— ë‹´ê¸°ëŠ” ë°ì´í„°ëŠ” repository_dispatch ì›¹í›…ì„ íŠ¸ë¦¬ê±°í•  ë•Œ í•¨ê»˜ ë³´ë‚´ëŠ” ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ë„£ì–´ì£¼ë©´ ëœë‹¤.

```json
// event-data.json
{
  "client_payload": {
    "testmsg": "í—¬ë¡œì›”ë“œ"
  }
}
```

ê·¸ë¦¬ê³  ì•¡ì…˜ì„ ì‹¤í–‰í•  ë•Œ, `-e, --event_path` ì˜µì…˜ì„ ì‚¬ìš©í•œë‹¤.

```bash
act -j test_repo_dispatch -e event-data.json
```

ì´ ê°’ì€ `github.event` ê°’ì„ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

<br/>

**ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ**
```yaml
on:
  repository_dispatch:
    types: [test]

jobs:
  test_repo_dispatch:
    runs-on: ubuntu-latest
    steps:
      - env:
          MESSAGE: ${{ github.event.client_payload.testmsg }}
        run: echo $MESSAGE
```

**ê²°ê³¼**

```bash
âœ  act -j test_repo_dispatch -e event-data.json
[test_repo_dispatch.yml/test_repo_dispatch] ğŸš€  Start image=catthehacker/ubuntu:act-latest
[test_repo_dispatch.yml/test_repo_dispatch]   ğŸ³  docker pull image=catthehacker/ubuntu:act-latest platform= username= forcePull=true
[test_repo_dispatch.yml/test_repo_dispatch]   ğŸ³  docker create image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[]
[test_repo_dispatch.yml/test_repo_dispatch]   ğŸ³  docker run image=catthehacker/ubuntu:act-latest platform= entrypoint=["tail" "-f" "/dev/null"] cmd=[]
[test_repo_dispatch.yml/test_repo_dispatch] â­ Run Main echo $MESSAGE
[test_repo_dispatch.yml/test_repo_dispatch]   ğŸ³  docker exec cmd=[bash --noprofile --norc -e -o pipefail /var/run/act/workflow/0] user= workdir=
| í—¬ë¡œ ì›”ë“œ
[test_repo_dispatch.yml/test_repo_dispatch]   âœ…  Success - Main echo $MESSAGE
[test_repo_dispatch.yml/test_repo_dispatch] ğŸ  Job succeeded
```

### ì‹¤í–‰ ì‹œ ìì£¼ ê²ªëŠ” ë¬¸ì œ

#### 1) `Cannot connect to the Docker daemon`

ë„ì»¤ê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ì

#### 2) ` Could not get auth config from docker config: error getting credentials`

ë„ì»¤ë¥¼ ì²˜ìŒ ì‹¤í–‰í•œ í›„ jobì„ ì‹¤í–‰í•˜ë ¤ê³  í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤.

```
[make recent post list/make] Could not get auth config from docker config: error getting credentials - err: exec: "docker-credential-desktop": executable file not found in $PATH, out: ``
Error: error getting credentials - err: exec: "docker-credential-desktop": executable file not found in $PATH, out: ``
```

`vim ~/.docker/config.json` ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•´ì„œ íŒŒì¼ì„ ì—´ë©´, ì•„ë˜ì™€ ê°™ì´ í‚¤ ê°’ì´ cred**s**Storeë¼ê³  ë˜ì–´ ìˆì„ ê²ƒì´ë‹¤.

```json
// as-is
{
  "credsStore": "desktop"
}
```

í‚¤ë¥¼ **`credStore`** ë¡œ ìˆ˜ì •í•´ì„œ ì €ì¥í•˜ë©´ ì •ìƒ ì‘ë™í•œë‹¤.

```json
// to-be
{
  "credStore": "desktop"
}
```

#### 3) Skipping unsupported platform

actê°€ ì§€ì›í•˜ëŠ” ëŸ¬ë„ˆëŠ” `ubuntu-latest`, `ubuntu-22.04`, `ubuntu-20.04`, `ubuntu-18.04` ë¿ì´ë‹¤. windowì™€ macOS í”Œë«í¼ì€ ì§€ì›ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, ì›Œí¬í”Œë¡œìš° works-onì— ìœ„ ëŸ¬ë„ˆ ì™¸ì˜ í”Œë«í¼ì´ ì§€ì •ë˜ì–´ ìˆë‹¤ë©´ jobì„ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ì—†ë‹¤.

ê°€ì¥ ì‰½ê²Œ í•´ê²°í•˜ëŠ” ë°©ë²•ì€ actë¥¼ ì‚¬ìš©í•˜ëŠ” ë™ì•ˆ works-onì„ ubuntu-latestë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ë‹¤.

export const meta = PostUtil.createPostMeta({
    index: 67,
    title: "Act: ë¡œì»¬ì—ì„œ GitHub Actions ì‹¤í–‰í•˜ê¸°",
    description: "GitHub ì•¡ì…˜ì„ ì¶”ê°€í•˜ê¸° ì „ì— ë¡œì»¬ì—ì„œ ì¶©ë¶„íˆ í…ŒìŠ¤íŠ¸í•´ë³¼ ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” actë¥¼ ì†Œê°œí•©ë‹ˆë‹¤",
    category: '',
    series: "",
    tags: ["Github Actions"],
    postedAt: '2023.06.17.',
});
export default ({children}) => <PostLayout meta={meta}>{children}</PostLayout>;
